var date1 = new Date();
var milsecs = date1.getMilliseconds();
console.log("start" + milsecs);

function getCookies() {
    var cookiesList = document.cookie.split(';');
    var cookieObj = {};
    for (var i = 1; i <= cookiesList.length; i++) {
        var objval = cookiesList[i - 1].split('=');
        cookieObj[objval[0].trim()] = objval[1];
    }
    return cookieObj;
}

function loadScript(url, async_flag) {
    var dynamicScriptTag = document.createElement("script");
    dynamicScriptTag.type = "text/javascript"
    dynamicScriptTag.src = url
    if (async_flag) {
        dynamicScriptTag.async = true
    }
    var headerTag = document.getElementsByTagName('head')[0];
    headerTag.appendChild(dynamicScriptTag);


}
function getCookieLaunch(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
      var c = ca[i];
      while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }
    }
    return "";
  }
function getoneTrustLaunch() {
    var onetrustval = getCookieLaunch('OptanonConsent');
    if (onetrustval) {
        var decodedurl;
        if (onetrustval.indexOf('groups=') > -1) {
            decodedurl = onetrustval.substr(onetrustval.indexOf('groups='));
            if (decodedurl != "") {
                decodedurl = decodedurl.split("=").length > 0 ? decodedurl.split("=")[1] : '';
                var subcat = decodeURIComponent(decodedurl);
                if (decodedurl.indexOf('&') > -1) {
                    subcat = decodeURIComponent(decodedurl.split('&')[0]);
                }
                subcat = subcat.split(',');
                var subcatobj = {};
                subcat.forEach(function (cur, ind) {
                    var ar = cur.split(':');
                    subcatobj[ar[0]] = ar[1];
                });
                return subcatobj;
            }
  
        }
  
    }
    return '';
  }
var dataCookie = getCookies();
//var exposureCookieVal = dataCookie.at_exposure;
//var marketingCookieVal = dataCookie['sattrack-marketing'];
var oneTrustVal = getoneTrustLaunch();
var marketingCookieVal = oneTrustVal ? oneTrustVal['C2'] : '';
//console.log("launchScript" ,getCookieLaunch('OptanonConsent'))
const article = document.querySelector('.page-information-dtml');
var flickerScript = article.dataset.antiflickeringclientlibpath;
var launchScript = article.dataset.dtmlibrary;

if (marketingCookieVal == "1") {
    var date2 = new Date();
    var milsecs1 = date2.getMilliseconds();
   console.log("flicker-code-start" + milsecs1);

    (function(win, doc, style, timeout) {
        var STYLE_ID = 'at-body-style';

        function getParent() {
            return doc.getElementsByTagName('head')[0];
        }

        function addStyle(parent, id, def) {
            if (!parent) {
                return;
            }

            var addAntiFlickeringStyle = doc.createElement('style');
            addAntiFlickeringStyle.id = id;
            addAntiFlickeringStyle.innerHTML = def;
            parent.appendChild(addAntiFlickeringStyle);
        }

        function removeStyle(parent, id) {
            if (!parent) {
                return;
            }

            var removeAntiFlickeringStyle = doc.getElementById(id);

            if (!removeAntiFlickeringStyle) {
                return;
            }

            parent.removeChild(removeAntiFlickeringStyle);
        }

        addStyle(getParent(), STYLE_ID, style);
        var date3 = new Date();
        var milsecs2 = date3.getMilliseconds();
       console.log("flicker-code-end" + milsecs2);
        setTimeout(function() {
            removeStyle(getParent(), STYLE_ID);
        }, timeout);
    }(window, document, "body {opacity: 0 !important}", 3000));
    loadScript(launchScript, true);
} else {
    loadScript(launchScript, true);
}